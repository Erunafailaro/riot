<?xml version="1.0" encoding="UTF-8"?>
<beans
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:override="http://www.riotfamily.org/schema/common/override"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
		http://www.springframework.org/schema/util
		http://www.springframework.org/schema/util/spring-util-2.0.xsd
		http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
		http://www.riotfamily.org/schema/common/override
		http://www.riotfamily.org/schema/common/override-6.5.xsd">
		
	<!--
		- Controller that displays the sitemap as DHTML tree. Used by the
		- internalLink form element.
		-->
	<bean id="pageChooserController" name="/pages/chooser"
		class="org.riotfamily.pages.riot.chooser.PageChooserController">

		<constructor-arg ref="pageDao" />
		<constructor-arg ref="pageLocationResolver" />
	</bean>


	<!-- Overrides -->

	<override:add ref="messageBasenames">
		<value>classpath:/org/riotfamily/pages/runtime/i18n/messages</value>
	</override:add>
	
	<override:add ref="customStyleSheets">
		<value>style/riot-pages.css</value>
	</override:add>
	
	<override:add ref="listRepository" property="configLocations">
		<value>classpath:/org/riotfamily/pages/runtime/riot-config.xml</value>
	</override:add>
	
	<override:add ref="formRepository" property="configLocations">
		<value>classpath:/org/riotfamily/pages/runtime/riot-config.xml</value>
	</override:add>
	
	<override:add ref="editorRepository" property="configLocations">
		<value>classpath:/org/riotfamily/pages/runtime/riot-config.xml</value>
	</override:add>

	<override:put ref="customFormElements">
		<entry key="internalLink" value="org.riotfamily.pages.riot.chooser.InternalLinkField" />
	</override:put>
				
	<override:add ref="resourceController" property="mappings">			
		<bean class="org.riotfamily.common.web.resource.ResourceMapping">
			<property name="path" value="/" />
			<property name="location" value="classpath:/org/riotfamily/pages/runtime/resources/" />
		</bean>
	</override:add>


	<!-- DAOs and models -->

	<bean id="siteRiotDao" class="org.riotfamily.pages.riot.dao.SiteRiotDao">
		<property name="pageDao" ref="pageDao" />
	</bean>

	<bean id="localeRiotDao" class="org.riotfamily.pages.riot.dao.LocaleRiotDao">
		<property name="pageDao" ref="pageDao" />
	</bean>

 	<bean id="pageRiotDao" class="org.riotfamily.pages.riot.dao.PageRiotDao">
		<property name="pageDao" ref="pageDao" />
	</bean>

	<bean id="localesOptionsModel" class="org.riotfamily.forms.element.select.StaticOptionsModel">
		<constructor-arg ref="websiteLocales" />
	</bean>


	<!-- Customised Page Commands -->

	<bean id="publishPageCommand" class="org.riotfamily.pages.riot.command.PublishPageCommand" />

	<bean id="moveUpPageCommand" class="org.riotfamily.pages.riot.command.SwapPageCommand">
		<property name="swapWith" value="-1" />
	</bean>

	<bean id="moveDownPageCommand" class="org.riotfamily.pages.riot.command.SwapPageCommand">
		<property name="swapWith" value="1" />
	</bean>

	<bean id="cutPageCommand" class="org.riotfamily.pages.riot.command.CutPageCommand" />

	<bean id="editPageCommand" class="org.riotfamily.pages.riot.command.EditPageCommand">
		<constructor-arg ref="pageDao" />
	</bean>

	<bean id="deletePageCommand" class="org.riotfamily.pages.riot.command.DeletePageCommand" />

	<bean id="gotoPageCommand" class="org.riotfamily.pages.riot.command.GotoPageCommand">
		<constructor-arg ref="pageLocationResolver" />
		<property name="windowName" value="preview" />
	</bean>

	<bean id="showChildPagesCommand" class="org.riotfamily.pages.riot.command.ShowChildPagesCommand" />

	<bean id="pastePageCommand" class="org.riotfamily.pages.riot.command.PastePageCommand">
		<constructor-arg ref="pageDao" />
	</bean>

</beans>