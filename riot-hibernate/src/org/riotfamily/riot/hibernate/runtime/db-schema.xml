<beans
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:db="http://www.riotfamily.org/schema/revolt"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
		http://www.riotfamily.org/schema/revolt
		http://www.riotfamily.org/schema/revolt/revolt-0.1.xsd
		http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
	
	<db:history module="riot" data-source="riotDataSource">
		<db:change-set id="initial">
			<db:create-table name="riot_session_data">
				<db:column name="principal" type="VARCHAR" length="255" not-null="true" primary-key="true" />
				<db:column name="lastLoginDate" type="TIMESTAMP" />
				<db:column name="lastLoginIP" type="VARCHAR" length="255" />
			</db:create-table>
			
			<db:create-table name="riot_users">
				<db:column name="id" type="VARCHAR" length="255" not-null="true" primary-key="true" />
				<db:column name="`password`" type="VARCHAR" length="255" />
				<db:column name="role" type="VARCHAR" length="255" />
				<db:column name="name" type="VARCHAR" length="255" />
				<db:column name="email" type="VARCHAR" length="255" />
			</db:create-table>
			
			<db:create-table name="riot_notification">
				<db:column name="id" type="BIGINT" not-null="true" primary-key="true" auto-increment="true" />
				<db:column name="message" type="LONGVARCHAR" />
				<db:column name="category" type="VARCHAR" length="255" />
				<db:column name="issueDate" type="VARCHAR" length="255" />
			</db:create-table>
			<db:create-table name="riot_user_notification">
				<db:column name="id" type="BIGINT" not-null="true" primary-key="true" auto-increment="true" />
				<db:column name="`user`" type="VARCHAR" length="255" />
				<db:column name="notification" type="BIGINT" />
				<db:column name="read" type="BIT" />
			</db:create-table>
			<db:add-foreign-key table="riot_user_notification" name="notification" references="riot_notification">
				<db:ref local="notification" foreign="id" />
			</db:add-foreign-key>
			
			<db:create-table name="riot_jobs">
				<db:column name="id" type="BIGINT" not-null="true" primary-key="true" auto-increment="true" />
				<db:column name="type" type="VARCHAR" length="255" />
				<db:column name="name" type="VARCHAR" length="255" />
				<db:column name="description" type="VARCHAR" length="255" />
				<db:column name="state" type="TINYINT" />
				<db:column name="objectId" type="VARCHAR" length="255" />
				<db:column name="stepsTotal" type="INTEGER" />
				<db:column name="stepsCompleted" type="INTEGER" />
				<db:column name="executionTime" type="INTEGER" />
				<db:column name="averageStepTime" type="BIGINT" />
				<db:column name="startDate" type="TIMESTAMP" />
				<db:column name="endDate" type="TIMESTAMP" />		
			</db:create-table>
			
			<db:create-table name="riot_job_log">
				<db:column name="id" type="BIGINT" not-null="true" primary-key="true" auto-increment="true" />
				<db:column name="job" type="BIGINT" />
				<db:column name="date" type="TIMESTAMP" />
				<db:column name="priority" type="INTEGER" />
				<db:column name="message" type="VARCHAR" length="255" />
			</db:create-table>
			<db:add-foreign-key table="riot_job_log" name="job" references="riot_jobs">
				<db:ref local="job" foreign="id" />
			</db:add-foreign-key>
		</db:change-set>
	</db:history>
	
</beans>